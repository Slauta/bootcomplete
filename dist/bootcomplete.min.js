var bootcomplete=angular.module("bootcomplete",[]);bootcomplete.directive("bootcomplete",["$compile","$templateRequest","$timeout","$sce",function(a,b,c,d){return{restric:"E",transclude:!0,replace:!0,scope:{btcSize:"@",btcTemplate:"@",btcMinlength:"@",btcLabel:"@",btcPlaceholder:"@",btcMaxresults:"@",btcNoresults:"@",btcQuery:"=",btcCallback:"="},template:"<div class='input-group input-group-{{btcSize}}'>\n<input placeholder='{{btcPlaceholder}}' type='text' class='form-control' ng-blur='blur($event)' autocomplete=\"off\"/>\n<span class='input-group-addon'><i class='fa fa-refresh' ng-class=\"{'fa-spin': loading }\"></i></span>\n</div>",link:function(e,f,g,h){var i=f[0].querySelector(".form-control"),j='<ul class="dropdown-menu" style="position:static;display:block;float:none;}">\n<li ng-class="{\'active\':selectedIndex === $index}" ng-repeat="result in results" ng-show="results.length">\n<a class="btc-clickLink" ng-style="{\'white-space\':\'normal\'}" href="" ng-click="select($index)" ng-bind-html="result.btclabel"></a>\n</li>\n<li class="disabled" ng-hide="results.length">\n<a href="">{{noresultsMsg}}</a>\n</li>\n</ul>';e.results=[],e.selectedIndex=-1,e.minlength=e.btcMinlength||1,e.noresultsMsg=e.btcNoresults||"Your search yielded no results",e.select=function(a){e.btcTemplate||delete e.results[a].btclabel,f.controller("ngModel").$setViewValue(e.results[a]),e.btcCallback.call(),e.close()},e.close=function(){e.visible=!1,e.selectedIndex=-1,i.value=""},e.blur=function(a){setTimeout(function(){var a=document.activeElement;"A"!==a.tagName&&-1===a.className.indexOf("btc-clickLink")&&(e.close(),e.$apply())},1)},e.makeDom=function(a){document.body.appendChild(a)},i.onkeyup=function(a){if(e.search=a.target.value,e.search.length>=e.minlength&&40!==a.keyCode&&38!==a.keyCode){e.loading=!0;var b=e.btcQuery.call(null,e.search);b.then(function(a){e.results=e.btcMaxresults?a.slice(0,e.btcMaxresults):a,e.btcTemplate||e.results.map(function(a){return a.btclabel=a[e.btcLabel],a.btclabel=d.trustAsHtml(a[e.btcLabel].replace(new RegExp(e.search,"gi"),"<strong>$&</strong>")),a}),e.visible=!0,c(function(){e.loading=!1},100)})}e.search.length||e.close()},f[0].onkeydown=function(a){40===a.keyCode&&(e.selectedIndex+1===e.results.length?e.selectedIndex=0:e.selectedIndex++),38===a.keyCode&&(0===e.selectedIndex&&(e.selectedIndex=e.results.length-1),-1===e.selectedIndex?e.selectedIndex=0:e.selectedIndex--),13===a.keyCode&&-1!=e.selectedIndex&&e.select(e.selectedIndex),27!==a.keyCode&&9!==a.keyCode||e.close(),e.$apply()};var k="<div ng-show='visible' ng-style=\"{'position':'fixed','z-index':'10000','top':top,'left':left,'width':width}\" >",l="</div>",m=function(a){var b=document.documentElement,c=a.getBoundingClientRect(),d=c.top+window.pageYOffset-b.clientTop,e=c.left+window.pageXOffset-b.clientLeft;return{top:d+c.height+1+"px",left:e+"px",width:c.width+"px"}};if(e.top=m(i).top,e.left=m(i).left,e.width=m(i).width,e.btcTemplate)b(e.btcTemplate).then(function(b){var c=k+b+l,d=a(c)(e)[0];e.makeDom(d)});else{var n=k+j+l,o=a(n)(e)[0];e.makeDom(o)}}}}]);